{"version":3,"file":"switch_view.min.js","sources":["../src/switch_view.js"],"sourcesContent":["//import log from 'core/log';\nimport ajax from 'core/ajax';\nimport templates from 'core/templates';\nimport config from 'core/config';\nimport notification from 'core/notification';\nimport $ from 'jquery';\nimport item_load from 'block_msmycourses2/item_load';\nimport * as slider from 'block_msmycourses2/course_slider';\n\nexport const init = (id) => {\n\n          $('section').on(\"click\",'#inst'+id+' .switch_view', function () {\n                  msmycourses_switch_view($(this),id);\n                  msmycourses_alt_view_savestate(id);\n                  return false;\n          });\n\n};\n\nconst msmycourses_switch_view = (element,id) =>  {\n\n                        if(element.data('target') == 'menu') {\n                                var promises = ajax.call([\n                                {\n                                        methodname: 'block_msmycourses2_load_menu_category',\n                                        args: {\n                                                blockid: id,\n                                                current_view: element.data('currentview'),\n                                                switch_view: 1\n                                        }\n                                }\n                                ]);\n                        }\n                        else {\n\n                                var promises = ajax.call([\n                                {\n                                        methodname: 'block_msmycourses2_show_more',\n                                        args: {\n                                                blockid: id,\n                                                offset: 0,\n                                                prev: 0,\n                                                current_view: element.data('currentview'),\n                                                switch_view: 1,\n                                                load_savestate: 1\n                                        }\n                                }\n                                ]);\n                        }\n\n                        promises[0].done(function(response) {\n\n                                    var template_type;\n\n                                    if(element.data('target') == 'list') {\n                                        template_type = \"block_msmycourses2/list\";\n                                    }\n                                    if(element.data('target') == 'page') {\n                                        template_type = \"block_msmycourses2/page\";\n                                    }\n                                    if(element.data('target') == 'menu') {\n                                        template_type = \"block_msmycourses2/menu\";\n                                    }\n                                    if(response.slider) {\n                                        if(response.records.length == 0 && response.children.length == 0) {\n                                            template_type = \"block_msmycourses2/empty\";\n                                        }\n                                    }\n                                    else {\n                                        if(response.records.length == 0) {\n                                            template_type = \"block_msmycourses2/empty\";\n                                        }\n                                    }\n                                    response.config = config;\n\n                                    templates.render(template_type, response).then(function (html, js) {\n                                                templates.replaceNode('#inst'+id+' .msmycourses_wrapper', html, js);\n                                                var swiper_element = document.getElementById('inst'+id)\n                                                            .getElementsByClassName('items')[0].firstElementChild;\n                                                if($(swiper_element).hasClass('swiper')) {\n                                                    slider.init($(swiper_element).parent(),response.slider_config);\n                                                }\n                                                $(\".block_msmycourses2 .savestate_open\").each(function() {\n                                                    if (!$(this).hasClass('open')) {\n                                                          item_load.savestate_open($(this), id, true);\n                                                    }\n                                                });\n                                            }).fail(notification.exception);\n\n                                    if(response.next) {\n                                        templates.render('block_msmycourses2/more', response).then(function (html, js) {\n                                                templates.replaceNode('#inst'+id+' .show_more', html, js);\n                                            }).fail(notification.exception);\n                                    }\n                                    else {\n                                        $('#inst'+id+' .show_more').remove();\n                                    }\n\n\n\n                        }).fail(notification.exception);\n\n};\n\nconst msmycourses_alt_view_savestate = (id) => {\n\n          var promises = ajax.call([\n          {\n                methodname: 'block_msmycourses2_savestates_alt_view',\n                args: {\n                          blockid: id\n                }\n          }\n          ]);\n\n          promises[0].done(function() {\n          }).fail(notification.exception);\n};"],"names":["id","on","msmycourses_switch_view","this","msmycourses_alt_view_savestate","element","data","promises","ajax","call","methodname","args","blockid","current_view","switch_view","offset","prev","load_savestate","done","response","template_type","slider","records","length","children","config","render","then","html","js","replaceNode","swiper_element","document","getElementById","getElementsByClassName","firstElementChild","hasClass","init","parent","slider_config","each","savestate_open","fail","notification","exception","next","remove"],"mappings":"g4DASoB,SAACA,wBAET,WAAWC,GAAG,QAAQ,QAAQD,GAAG,iBAAiB,kBAC5CE,yBAAwB,mBAAEC,MAAMH,IAChCI,+BAA+BJ,KACxB,UAKnBE,wBAA0B,SAACG,QAAQL,OAEY,QAA1BK,QAAQC,KAAK,cACJC,SAAWC,cAAKC,KAAK,CACzB,CACQC,WAAY,wCACZC,KAAM,CACEC,QAASZ,GACTa,aAAcR,QAAQC,KAAK,eAC3BQ,YAAa,WAOzBP,SAAWC,cAAKC,KAAK,CACzB,CACQC,WAAY,+BACZC,KAAM,CACEC,QAASZ,GACTe,OAAQ,EACRC,KAAM,EACNH,aAAcR,QAAQC,KAAK,eAC3BQ,YAAa,EACbG,eAAgB,MAMxCV,SAAS,GAAGW,MAAK,SAASC,cAEVC,cAEyB,QAA1Bf,QAAQC,KAAK,YACZc,cAAgB,2BAES,QAA1Bf,QAAQC,KAAK,YACZc,cAAgB,2BAES,QAA1Bf,QAAQC,KAAK,YACZc,cAAgB,2BAEjBD,SAASE,OACsB,GAA3BF,SAASG,QAAQC,QAA2C,GAA5BJ,SAASK,SAASD,SACjDH,cAAgB,4BAIU,GAA3BD,SAASG,QAAQC,SAChBH,cAAgB,4BAGxBD,SAASM,OAASA,mCAERC,OAAON,cAAeD,UAAUQ,MAAK,SAAUC,KAAMC,uBACzCC,YAAY,QAAQ9B,GAAG,wBAAyB4B,KAAMC,QAC5DE,eAAiBC,SAASC,eAAe,OAAOjC,IACvCkC,uBAAuB,SAAS,GAAGC,mBAC7C,mBAAEJ,gBAAgBK,SAAS,WAC1Bf,OAAOgB,MAAK,mBAAEN,gBAAgBO,SAASnB,SAASoB,mCAElD,uCAAuCC,MAAK,YACrC,mBAAErC,MAAMiC,SAAS,4BACNK,gBAAe,mBAAEtC,MAAOH,IAAI,SAGjD0C,KAAKC,sBAAaC,WAE1BzB,SAAS0B,wBACEnB,OAAO,0BAA2BP,UAAUQ,MAAK,SAAUC,KAAMC,uBACzDC,YAAY,QAAQ9B,GAAG,cAAe4B,KAAMC,OACvDa,KAAKC,sBAAaC,+BAGvB,QAAQ5C,GAAG,eAAe8C,YAKzCJ,KAAKC,sBAAaC,YAIvCxC,+BAAiC,SAACJ,IAEfQ,cAAKC,KAAK,CACzB,CACMC,WAAY,yCACZC,KAAM,CACIC,QAASZ,OAKhB,GAAGkB,MAAK,eACdwB,KAAKC,sBAAaC"}