{"version":3,"file":"collapse.min.js","sources":["../src/collapse.js"],"sourcesContent":["//import log from 'core/log';\nimport ajax from 'core/ajax';\n//import templates from 'core/templates';\n//import config from 'core/config';\nimport notification from 'core/notification';\nimport $ from 'jquery';\nimport item_load from 'block_mycourse/item_load';\n\nexport const init = (id) => {\n\n    $('section').on(\"click\",'#inst'+id+'.block_mycourse .collapse_item', function (e) {\n            item_collapse_click($(this).parent(), id, e);\n            return false;\n    });\n\n    $('#inst'+id+'.block_mycourse .savestate_open').each(function() {\n        if (!$(this).hasClass('open')) {\n            item_collapse($(this), id, false, true);\n        }\n    });\n};\n\nconst item_collapse = (item, id, resize,load_savestate) => {\n                var current_view = 0;\n                var switch_view = $(item).closest('.msmycourses_wrapper').find('.switch_view');\n\n                if(switch_view.data('currentview') == 1) {\n                    current_view = 1;\n                }\n\n                if (typeof resize === 'undefined') { resize = true; }\n                if ($(item).hasClass('open')) {\n                        item.removeClass('open');\n                        if(resize) {$(window).trigger(\"resize\");}\n                        var savestate = ajax.call([\n                                      {\n                                            methodname: 'block_mycourse_savestates_collapse',\n                                            args: {\n                                                      blockid: id,\n                                                      category: $(item).data('id'),\n                                                      current_view: current_view,\n                                                      type: 'close'\n                                            }\n                                      }\n                        ]);\n\n                        savestate[0].done(function() {\n                        }).fail(notification.exception);\n                        return true; //extra, and to make sure the function has consistent return points\n                } else {\n                        item.addClass('open');\n                        if(item.find('.children').children().length == 0) {\n                              item_load.msmycourses_item_load(item,id,load_savestate);\n                        }\n                        var savestate = ajax.call([\n                                      {\n                                            methodname: 'block_mycourse_savestates_collapse',\n                                            args: {\n                                                      blockid: id,\n                                                      category: $(item).data('id'),\n                                                      current_view: current_view,\n                                                      type: 'open'\n                                            }\n                                      }\n                        ]);\n\n                        savestate[0].done(function() {\n                        }).fail(notification.exception);\n                if(resize) {$(window).trigger(\"resize\");}\n                return false; //extra, and to make sure the function has consistent return points\n                }\n        };\n\nconst item_collapse_click =(obj, id, event) => {\n                event.stopPropagation();\n                event.preventDefault();\n\n                item_collapse(obj,id,false,false);\n};\n\n"],"names":["id","on","e","item_collapse_click","this","parent","each","hasClass","item_collapse","item","resize","load_savestate","current_view","closest","find","data","removeClass","window","trigger","ajax","call","methodname","args","blockid","category","type","done","fail","notification","exception","addClass","children","length","msmycourses_item_load","obj","event","stopPropagation","preventDefault"],"mappings":"+gBAQoB,SAACA,wBAEf,WAAWC,GAAG,QAAQ,QAAQD,GAAG,sCAAsC,SAAUE,UAC3EC,qBAAoB,mBAAEC,MAAMC,SAAUL,GAAIE,IACnC,yBAGb,QAAQF,GAAG,uCAAuCM,MAAK,YAChD,mBAAEF,MAAMG,SAAS,SAClBC,eAAc,mBAAEJ,MAAOJ,IAAI,GAAO,WAKxCQ,cAAgB,SAACC,KAAMT,GAAIU,OAAOC,oBACpBC,aAAe,SAGmB,IAFpB,mBAAEH,MAAMI,QAAQ,wBAAwBC,KAAK,gBAEhDC,KAAK,iBAChBH,aAAe,QAGG,IAAXF,SAA0BA,QAAS,IAC1C,mBAAED,MAAMF,SAAS,SACbE,KAAKO,YAAY,QACdN,4BAAWO,QAAQC,QAAQ,UACdC,cAAKC,KAAK,CACZ,CACMC,WAAY,yCACZC,KAAM,CACIC,QAASvB,GACTwB,UAAU,mBAAEf,MAAMM,KAAK,MACvBH,aAAcA,aACda,KAAM,YAK1B,GAAGC,MAAK,eACfC,KAAKC,sBAAaC,YACd,IAEPpB,KAAKqB,SAAS,QACiC,GAA5CrB,KAAKK,KAAK,aAAaiB,WAAWC,2BACrBC,sBAAsBxB,KAAKT,GAAGW,gBAE9BQ,cAAKC,KAAK,CACZ,CACMC,WAAY,yCACZC,KAAM,CACIC,QAASvB,GACTwB,UAAU,mBAAEf,MAAMM,KAAK,MACvBH,aAAcA,aACda,KAAM,WAK1B,GAAGC,MAAK,eACfC,KAAKC,sBAAaC,WAC1BnB,4BAAWO,QAAQC,QAAQ,WACvB,IAIjBf,oBAAqB,SAAC+B,IAAKlC,GAAImC,OACrBA,MAAMC,kBACND,MAAME,iBAEN7B,cAAc0B,IAAIlC,IAAG,GAAM"}