{"version":3,"file":"item_load.min.js","sources":["../src/item_load.js"],"sourcesContent":["import log from 'core/log';\nimport ajax from 'core/ajax';\nimport templates from 'core/templates';\nimport config from 'core/config';\nimport notification from 'core/notification';\nimport $ from 'jquery';\nimport * as slider from 'block_msmycourses2/course_slider';\n\nclass item_load {\n\nstatic msmycourses_item_load = (item,id,load_savestate) => {\n\n                var current_view = 0;\n                var switch_view = $(item).closest('.msmycourses_wrapper').find('.switch_view');\n\n                if(switch_view.data('currentview') == 1) {\n                    current_view = 1;\n                }\n\n                var promise = ajax.call([\n                {\n                        methodname: 'block_msmycourses2_load_category',\n                                      args: {\n                                              blockid: id,\n                                              category_id: $(item).data('id'),\n                                              level: $(item).data('level'),\n                                              current_view: current_view,\n                                              load_savestate: load_savestate,\n                                      }\n                        }\n                ]);\n\n    promise[0].done(function (response) {\n        log.debug(response);\n                      if(response.slider == 0) {\n                          var count = 0;\n                          $.each(response.records, function(key, record){\n                                    record.config = config;\n                                    record.show_favorites = response.show_favorites;\n                                    record.remove_activities = response.remove_activities;\n                                    record.is_compact_view = response.is_compact_view;\n                                    templates.render('block_msmycourses2/item', record).then(function (html, js) {\n                                                    templates.appendNodeContents($(item).children('.children'), html, js);\n                                                    count++;\n                                                    if(count == response.records.length && load_savestate) {\n                                                            $(\".block_msmycourses2 .savestate_open\").each(function() {\n                                                                if (!$(this).hasClass('open')) {\n                                                                    item_load.savestate_open($(this), id, false, true);\n                                                                }\n                                                            });\n                                                    }\n                                    }).fail(notification.exception);\n                          });\n                        }\n                        else {\n                                response.config = config;\n                                templates.render('block_msmycourses2/course_slider', response).then(function (html, js) {\n                                                      templates.appendNodeContents($(item).children('.children'), html, js);\n                                                      slider.init($(item),response.slider_config);\n                                                      if(load_savestate) {\n                                                            $(\".block_msmycourses2 .savestate_open\").each(function() {\n                                                                if (!$(this).hasClass('open')) {\n                                                                    item_load.savestate_open($(this), id, false, true);\n                                                                }\n                                                            });\n                                                      }\n                                }).fail(notification.exception);\n                        }\n\n                            if(response.is_compact_view) {\n                                            templates.render('block_msmycourses2/compact_selector', response)\n                                            .then(function (html, js) {\n                                                templates.replaceNode($(item).find('.compact_selector_wrapper'), html, js);\n                                            }).fail(notification.exception);\n                            }\n\n                                /*if($(item).data('level') > 0) {\n                                    $(item).find('.compact_selector_wrapper').remove();\n                                }*/\n                      }).fail(notification.exception);\n\n              return promise;\n\n};\n\nstatic savestate_open = (item, id, resize) => {\n\n                if (typeof resize === 'undefined') { resize = true; }\n                item.addClass('open');\n                if(item.find('.children').children().length == 0) {\n                              item_load.msmycourses_item_load(item,id,true);\n                }\n\n                if(resize) {$(window).trigger(\"resize\");}\n                return false; //extra, and to make sure the function has consistent return points\n        };\n\n}\nexport default item_load;\n"],"names":["item_load","item","id","load_savestate","current_view","closest","find","data","promise","ajax","call","methodname","args","blockid","category_id","level","done","response","debug","slider","count","each","records","key","record","config","show_favorites","remove_activities","is_compact_view","render","then","html","js","appendNodeContents","children","length","this","hasClass","savestate_open","fail","notification","exception","init","slider_config","replaceNode","resize","addClass","msmycourses_item_load","window","trigger"],"mappings":"4yEAQMA,+YAAAA,mCAEyB,SAACC,KAAKC,GAAGC,oBAEpBC,aAAe,EAGmB,IAFpB,mBAAEH,MAAMI,QAAQ,wBAAwBC,KAAK,gBAEhDC,KAAK,iBAChBH,aAAe,OAGfI,QAAUC,cAAKC,KAAK,CACxB,CACQC,WAAY,mCACEC,KAAM,CACEC,QAASX,GACTY,aAAa,mBAAEb,MAAMM,KAAK,MAC1BQ,OAAO,mBAAEd,MAAMM,KAAK,SACpBH,aAAcA,aACdD,eAAgBA,0BAK1DK,QAAQ,GAAGQ,MAAK,SAAUC,0BAClBC,MAAMD,UAC0B,GAAnBA,SAASE,OAAa,KACjBC,MAAQ,kBACVC,KAAKJ,SAASK,SAAS,SAASC,IAAKC,QAC7BA,OAAOC,OAASA,gBAChBD,OAAOE,eAAiBT,SAASS,eACjCF,OAAOG,kBAAoBV,SAASU,kBACpCH,OAAOI,gBAAkBX,SAASW,mCACxBC,OAAO,0BAA2BL,QAAQM,MAAK,SAAUC,KAAMC,uBAC/CC,oBAAmB,mBAAEhC,MAAMiC,SAAS,aAAcH,KAAMC,MAClEZ,OACYH,SAASK,QAAQa,QAAUhC,oCAC7B,uCAAuCkB,MAAK,YACrC,mBAAEe,MAAMC,SAAS,SAClBrC,UAAUsC,gBAAe,mBAAEF,MAAOlC,IAAI,GAAO,SAI1EqC,KAAKC,sBAAaC,mBAIzBxB,SAASQ,OAASA,mCACRI,OAAO,mCAAoCZ,UAAUa,MAAK,SAAUC,KAAMC,uBACpDC,oBAAmB,mBAAEhC,MAAMiC,SAAS,aAAcH,KAAMC,IAClEb,OAAOuB,MAAK,mBAAEzC,MAAMgB,SAAS0B,eAC1BxC,oCACK,uCAAuCkB,MAAK,YACrC,mBAAEe,MAAMC,SAAS,SAClBrC,UAAUsC,gBAAe,mBAAEF,MAAOlC,IAAI,GAAO,SAI9EqC,KAAKC,sBAAaC,WAGtBxB,SAASW,oCACcC,OAAO,sCAAuCZ,UACvDa,MAAK,SAAUC,KAAMC,uBACRY,aAAY,mBAAE3C,MAAMK,KAAK,6BAA8ByB,KAAMC,OACxEO,KAAKC,sBAAaC,cAMxCF,KAAKC,sBAAaC,WAEtBjC,2BAzEfR,4BA6EkB,SAACC,KAAMC,GAAI2C,oBAEG,IAAXA,SAA0BA,QAAS,GAC9C5C,KAAK6C,SAAS,QACiC,GAA5C7C,KAAKK,KAAK,aAAa4B,WAAWC,QACvBnC,UAAU+C,sBAAsB9C,KAAKC,IAAG,GAGnD2C,4BAAWG,QAAQC,QAAQ,WACvB,kBAIRjD"}