{"version":3,"file":"show_more.min.js","sources":["../src/show_more.js"],"sourcesContent":["//import log from 'core/log';\nimport ajax from 'core/ajax';\nimport templates from 'core/templates';\nimport config from 'core/config';\nimport notification from 'core/notification';\nimport $ from 'jquery';\nimport item_load from 'block_msmycourses2/item_load';\n\nexport const init = (id) => {\n\n          $('section').on(\"click\",'#inst'+id+' .show_more', function () {\n                  msmycourses_show_more($(this),id);\n                  return false;\n          });\n\n          $('section').on(\"click\",'#inst'+id+' .next', function () {\n                  msmycourses_page_shift($(this),id);\n                  return false;\n          });\n\n          $('section').on(\"click\", '#inst'+id+' .prev',function () {\n                  msmycourses_page_shift($(this),id);\n                  return false;\n          });\n};\n\nconst msmycourses_show_more = (element,id) =>  {\n                        var promises = ajax.call([\n                                {\n                                        methodname: 'block_msmycourses2_show_more',\n                                        args: {\n                                                blockid: id,\n                                                offset: element.data('current'),\n                                                switch_view: 0,\n                                                current_view: element.data('currentview')\n                                        }\n                                }\n                        ]);\n\n                        promises[0].done(function(response) {\n\n                                    if(response.slider) {\n                                        $.each(response.children, function(key, record){\n                                                  record.config = config;\n                                                  record.show_favorites = response.show_favorites;\n                                                  record.remove_activities = response.remove_activities;\n                                                  record.enable_compact_view = response.enable_compact_view;\n                                            templates.render('block_msmycourses2/child_category', record).then(function (html, js) {\n                                            templates.appendNodeContents($('#inst'+id+' .items').children('.categories'), html, js);\n                                                  }).fail(notification.exception);\n                                          });\n                                    }\n                                    else {\n                                          $.each(response.records, function(key, record){\n                                                  record.config = config;\n                                                  record.show_favorites = response.show_favorites;\n                                                  record.remove_activities = response.remove_activities;\n                                                  templates.render('block_msmycourses2/item', record).then(function (html, js) {\n                                                      templates.appendNodeContents('#inst'+id+' .items', html, js);\n                                                  }).fail(notification.exception);\n                                          });\n                                    }\n                                    if(response.next) {\n                                        templates.render('block_msmycourses2/more', response).then(function (html, js) {\n                                                templates.replaceNode('#inst'+id+' .show_more', html, js);\n                                            }).fail(notification.exception);\n                                    }\n                                    else {\n                                        $('#inst'+id+' .show_more').remove();\n                                    }\n\n                                    if(response.show_alt_view) {\n                                        templates.render('block_msmycourses2/switch_view', response).then(function (html, js) {\n                                                templates.replaceNode('#inst'+id+' .switch_view_wrapper', html, js);\n                                            }).fail(notification.exception);\n                                    }\n\n                        }).fail(notification.exception);\n};\n\nconst msmycourses_page_shift = (element,id) => {\n                        var promises = ajax.call([\n                                {\n                                        methodname: 'block_msmycourses2_show_more',\n                                        args: {\n                                                blockid: id,\n                                                offset: element.data('current'),\n                                                prev: element.data('prev'),\n                                                current_view: element.data('currentview')\n                                        }\n                                }\n                        ]);\n\n                        promises[0].done(function(response) {\n\n                                      response.config = config;\n                                      templates.render('block_msmycourses2/page', response).then(function (html, js) {\n                                                templates.replaceNode('#inst'+id+' .msmycourses_wrapper', html, js);\n                                                $(\".block_msmycourses2 .savestate_open\").each(function() {\n                                                    if (!$(this).hasClass('open')) {\n                                                          item_load.savestate_open($(this), id, true);\n                                                    }\n                                                });\n                                      }).fail(notification.exception);\n\n                                      if(response.show_alt_view) {\n                                        templates.render('block_msmycourses2/switch_view', response).then(function (html, js) {\n                                                templates.replaceNode('#inst'+id+' .switch_view_wrapper', html, js);\n                                            }).fail(notification.exception);\n                                      }\n\n                                      var savestate = ajax.call([\n                                      {\n                                            methodname: 'block_msmycourses2_savestates_page',\n                                            args: {\n                                                      blockid: id,\n                                                      current: response.first_element,\n                                                      current_view: element.data('currentview'),\n                                            }\n                                      }\n                                      ]);\n\n                                      savestate[0].done(function() {\n                                      }).fail(notification.exception);\n\n                        }).fail(notification.exception);\n};\n"],"names":["id","on","msmycourses_show_more","this","msmycourses_page_shift","element","ajax","call","methodname","args","blockid","offset","data","switch_view","current_view","done","response","slider","each","children","key","record","config","show_favorites","remove_activities","enable_compact_view","render","then","html","js","appendNodeContents","fail","notification","exception","records","next","replaceNode","remove","show_alt_view","prev","hasClass","savestate_open","current","first_element"],"mappings":"wpBAQoB,SAACA,wBAET,WAAWC,GAAG,QAAQ,QAAQD,GAAG,eAAe,kBAC1CE,uBAAsB,mBAAEC,MAAMH,KACvB,yBAGb,WAAWC,GAAG,QAAQ,QAAQD,GAAG,UAAU,kBACrCI,wBAAuB,mBAAED,MAAMH,KACxB,yBAGb,WAAWC,GAAG,QAAS,QAAQD,GAAG,UAAS,kBACrCI,wBAAuB,mBAAED,MAAMH,KACxB,UAInBE,sBAAwB,SAACG,QAAQL,IACAM,cAAKC,KAAK,CACjB,CACQC,WAAY,+BACZC,KAAM,CACEC,QAASV,GACTW,OAAQN,QAAQO,KAAK,WACrBC,YAAa,EACbC,aAAcT,QAAQO,KAAK,mBAK1C,GAAGG,MAAK,SAASC,UAEXA,SAASC,uBACNC,KAAKF,SAASG,UAAU,SAASC,IAAKC,QAC9BA,OAAOC,OAASA,gBAChBD,OAAOE,eAAiBP,SAASO,eACjCF,OAAOG,kBAAoBR,SAASQ,kBACpCH,OAAOI,oBAAsBT,SAASS,uCAClCC,OAAO,oCAAqCL,QAAQM,MAAK,SAAUC,KAAMC,uBACzEC,oBAAmB,mBAAE,QAAQ9B,GAAG,WAAWmB,SAAS,eAAgBS,KAAMC,OAC3EE,KAAKC,sBAAaC,8BAI3Bf,KAAKF,SAASkB,SAAS,SAASd,IAAKC,QAC/BA,OAAOC,OAASA,gBAChBD,OAAOE,eAAiBP,SAASO,eACjCF,OAAOG,kBAAoBR,SAASQ,qCAC1BE,OAAO,0BAA2BL,QAAQM,MAAK,SAAUC,KAAMC,uBAC3DC,mBAAmB,QAAQ9B,GAAG,UAAW4B,KAAMC,OAC1DE,KAAKC,sBAAaC,cAGhCjB,SAASmB,wBACET,OAAO,0BAA2BV,UAAUW,MAAK,SAAUC,KAAMC,uBACzDO,YAAY,QAAQpC,GAAG,cAAe4B,KAAMC,OACvDE,KAAKC,sBAAaC,+BAGvB,QAAQjC,GAAG,eAAeqC,SAG7BrB,SAASsB,kCACEZ,OAAO,iCAAkCV,UAAUW,MAAK,SAAUC,KAAMC,uBAChEO,YAAY,QAAQpC,GAAG,wBAAyB4B,KAAMC,OACjEE,KAAKC,sBAAaC,cAGtCF,KAAKC,sBAAaC,YAGvC7B,uBAAyB,SAACC,QAAQL,IACDM,cAAKC,KAAK,CACjB,CACQC,WAAY,+BACZC,KAAM,CACEC,QAASV,GACTW,OAAQN,QAAQO,KAAK,WACrB2B,KAAMlC,QAAQO,KAAK,QACnBE,aAAcT,QAAQO,KAAK,mBAK1C,GAAGG,MAAK,SAASC,UAEZA,SAASM,OAASA,mCACRI,OAAO,0BAA2BV,UAAUW,MAAK,SAAUC,KAAMC,uBACvDO,YAAY,QAAQpC,GAAG,wBAAyB4B,KAAMC,wBAC9D,uCAAuCX,MAAK,YACrC,mBAAEf,MAAMqC,SAAS,4BACNC,gBAAe,mBAAEtC,MAAOH,IAAI,SAGvD+B,KAAKC,sBAAaC,WAElBjB,SAASsB,kCACAZ,OAAO,iCAAkCV,UAAUW,MAAK,SAAUC,KAAMC,uBAChEO,YAAY,QAAQpC,GAAG,wBAAyB4B,KAAMC,OACjEE,KAAKC,sBAAaC,WAGX3B,cAAKC,KAAK,CAC1B,CACMC,WAAY,qCACZC,KAAM,CACIC,QAASV,GACT0C,QAAS1B,SAAS2B,cAClB7B,aAAcT,QAAQO,KAAK,mBAKjC,GAAGG,MAAK,eACfgB,KAAKC,sBAAaC,cAEhCF,KAAKC,sBAAaC"}